<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>かんたん筆談</title>
<meta name="viewport" content="width=device-width">
<meta name="keywords" content="">
<meta name="description" content="">
<link rel="stylesheet" type="text/css" href="css/style.css">
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/jquery.smoothscroll.js"></script>
<script type="text/javascript" src="js/jquery.scrollshow.js"></script>
<script type="text/javascript" src="js/script.js"></script>
<script>
$(function($){
	$('html').smoothscroll({easing : 'swing', speed : 1000, margintop : 30, headerfix : $('nav')});
	$('.totop').scrollshow({position : 500});
});
</script>
</head>
<body>


<header>
<h1>かんたん筆談</h1>
</header>

<nav>
<ul>
	<li><a href="index.html">メイン画面</a></li>
	<li><a href="index.html">使い方</a></li>
	<li><a href="index.html">メール</a></li>
</ul>
</nav>

<div id="contents">
	<h6 id="sample">ボタンを押しておしゃべりしてください
      <p>
      <input type="checkbox" class="toggle_button" name="mic" data-off-label="開始" data-on-label="終了">
      </p>
    </h6>
      <textarea class="speeched_area" rows="5" readonly></textarea>
         
</div><!-- /.contents -->

<footer>
	<div><small>distributed by N.Yamashita  ver. 1.002</small></div><!-- /.copyright -->
</footer>


      <script type="text/javascript">
      const recognition = new webkitSpeechRecognition();
      const textarea    = document.querySelector('textarea');
      const button      = document.querySelector("input[type='checkbox']");
      const mic_btn     = document.getElementsByName("mic");
      var status;
      var timer_id;


      button.addEventListener('click', function () {
      clearTimeout(timer_id);
      timer_id = setTimeout("btn_off()", 10000);

       if (status > 0 ) {
           recognition.stop();
           status = 0;
       }else{
           recognition.start();
           status = 9;
       }
      });

      function btn_off(){
        clearTimeout(timer_id);
        mic_btn.item(0).checked = false;
        status = 0;
      }

      recognition.onresult = function (e) {
        let result = e.results[0][0].transcript;
        textarea.value = result;
        btn_off();
      };
</script>

</body>
</html>
